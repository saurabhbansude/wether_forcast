<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Weather Forecast</title>
<style>
  html, body {
    height: 100%;
    margin: 0;
    font-family: Arial, sans-serif;
  }
  body {
    display: flex;
    justify-content: center;
    align-items: center;
    transition: background 0.5s ease;
    color: #fff;
    overflow: hidden;
    background: linear-gradient(to bottom, #87ceeb, #f0f8ff);
  }
  .container {
    max-width: 960px;
    width: 90%;
    background: rgba(0,0,0,0.5);
    border-radius: 16px;
    padding: 20px;
    box-shadow: 0 8px 24px rgba(0,0,0,0.6);
    text-align: center;
  }
  h1 { margin-bottom: 20px; }

  .controls {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin-bottom: 20px;
    flex-wrap: wrap;
  }
  input[type="text"] {
    padding: 8px 12px;
    border-radius: 8px;
    border: none;
    outline: none;
    width: 200px;
  }
  button {
    padding: 8px 12px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    font-weight: bold;
    transition: transform 0.2s, background 0.3s;
    background: #4fbeff;
    color: #001021;
  }
  button:hover {
    transform: scale(1.1);
    background: #ffa500;
  }

  .current-weather {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 20px;
    background: rgba(255,255,255,0.1);
    padding: 16px;
    border-radius: 12px;
    margin-bottom: 20px;
    transition: background 0.3s;
    flex-wrap: wrap;
  }
  .current-weather:hover { background: rgba(255,255,255,0.2); }
  .current-weather img { width: 100px; height: 100px; }
  .current-details { display: flex; flex-direction: column; gap: 6px; }
  .temp { font-size: 32px; font-weight: bold; }
  .desc { font-size: 18px; text-transform: capitalize; }

  .forecast {
    display: flex;
    gap: 12px;
    overflow-x: auto;
    padding-bottom: 10px;
    justify-content: center;
  }
  .day {
    min-width: 120px;
    background: rgba(255,255,255,0.1);
    padding: 10px;
    border-radius: 12px;
    text-align: center;
    transition: transform 0.2s, background 0.2s;
    cursor: pointer;
  }
  .day:hover { transform: translateY(-5px); background: rgba(255,255,255,0.2); }
  .day img { width: 60px; height: 60px; }

  .temp-hot { color: #ff4500; }
  .temp-cold { color: #00ffff; }
  .temp-mild { color: #ffff00; }

  .forecast::-webkit-scrollbar { height: 6px; }
  .forecast::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.3); border-radius: 3px; }

</style>
</head>
<body>
<div class="container">
  <h1>Weather Forecast</h1>
  <div class="controls">
    <input type="text" id="cityInput" placeholder="Enter city">
    <button id="searchBtn">Search</button>
    <button id="geoBtn">Use My Location</button>
  </div>
  <div class="current-weather" id="currentWeather">
    <img id="currentIcon" src="" alt="">
    <div class="current-details">
      <div id="currentLocation">—</div>
      <div class="desc" id="currentDesc">—</div>
      <div class="temp" id="currentTemp">—</div>
    </div>
  </div>
  <div class="forecast" id="forecastRow"></div>
</div>

<script>
const API_KEY = '5c550cb0e7d1f9d1ee6ffd77c30fa966'; // Replace with your key
const UNITS = 'metric';

const cityInput = document.getElementById('cityInput');
const searchBtn = document.getElementById('searchBtn');
const geoBtn = document.getElementById('geoBtn');
const currentLocation = document.getElementById('currentLocation');
const currentDesc = document.getElementById('currentDesc');
const currentTemp = document.getElementById('currentTemp');
const currentIcon = document.getElementById('currentIcon');
const forecastRow = document.getElementById('forecastRow');

async function fetchWeather(city) {
  try {
    const geoRes = await fetch(`https://api.openweathermap.org/geo/1.0/direct?q=${city}&limit=1&appid=${API_KEY}`);
    const geo = await geoRes.json();
    if(!geo || geo.length===0) throw new Error('Location not found');
    const { lat, lon } = geo[0];

    const [currentRes, forecastRes] = await Promise.all([
      fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=${UNITS}&appid=${API_KEY}`),
      fetch(`https://api.openweathermap.org/data/2.5/forecast?lat=${lat}&lon=${lon}&units=${UNITS}&appid=${API_KEY}`)
    ]);

    const current = await currentRes.json();
    const forecast = await forecastRes.json();

    renderCurrent(current);
    renderForecast(forecast);
  } catch(e) {
    alert(e.message);
  }
}

function renderCurrent(data) {
  currentLocation.textContent = `${data.name}, ${data.sys.country}`;
  currentDesc.textContent = data.weather[0].description;
  const t = Math.round(data.main.temp);
  currentTemp.textContent = `${t}°C`;

  if(t>=30) currentTemp.className='temp temp-hot';
  else if(t<=15) currentTemp.className='temp temp-cold';
  else currentTemp.className='temp temp-mild';

  currentIcon.src = `https://openweathermap.org/img/wn/${data.weather[0].icon}@2x.png`;
  currentIcon.alt = data.weather[0].description;

  const weatherMain = data.weather[0].main.toLowerCase();
  if(weatherMain.includes('rain')) document.body.style.background = "url('https://images.unsplash.com/photo-1601597111483-2f8f7d5d23a5?auto=format&fit=crop&w=1920&q=80') no-repeat center/cover";
  else if(weatherMain.includes('cloud')) document.body.style.background = "url('https://images.unsplash.com/photo-1501630834273-4b5604d2ee31?auto=format&fit=crop&w=1920&q=80') no-repeat center/cover";
  else document.body.style.background = "url('https://images.unsplash.com/photo-1501973801540-537f08ccae7f?auto=format&fit=crop&w=1920&q=80') no-repeat center/cover";
  document.body.style.backgroundSize = 'cover';
}

function renderForecast(data) {
  forecastRow.innerHTML = '';
  const tz = data.city.timezone;
  const picks = data.list.filter((item,i)=>i%8===0).slice(0,5);
  picks.forEach(day=>{
    const d = new Date((day.dt+tz)*1000);
    const dayName = d.toLocaleDateString(undefined,{weekday:'short', month:'short', day:'numeric'});
    const t = Math.round(day.main.temp);
    let tempClass='temp-mild';
    if(t>=30) tempClass='temp-hot';
    else if(t<=15) tempClass='temp-cold';
    const card = document.createElement('div');
    card.className='day';
    card.innerHTML = `
      <div>${dayName}</div>
      <img src="https://openweathermap.org/img/wn/${day.weather[0].icon}@2x.png" alt="${day.weather[0].description}">
      <div class="${tempClass}">${t}°C</div>
      <div>${day.weather[0].main}</div>
    `;
    forecastRow.appendChild(card);
  });
}

// Event listeners
searchBtn.addEventListener('click', ()=>{ fetchWeather(cityInput.value) });
cityInput.addEventListener('keydown', e=>{ if(e.key==='Enter') fetchWeather(cityInput.value) });
geoBtn.addEventListener('click', ()=>{
  navigator.geolocation.getCurrentPosition(pos=>{
    const {latitude: lat, longitude: lon} = pos.coords;
    fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=${UNITS}&appid=${API_KEY}`)
      .then(r=>r.json()).then(current=> renderCurrent(current));
    fetch(`https://api.openweathermap.org/data/2.5/forecast?lat=${lat}&lon=${lon}&units=${UNITS}&appid=${API_KEY}`)
      .then(r=>r.json()).then(forecast=> renderForecast(forecast));
  });
});

// Load default city or geolocation on page load
window.addEventListener('load', ()=>{
  if(navigator.geolocation){
    navigator.geolocation.getCurrentPosition(pos=>{
      const {latitude: lat, longitude: lon} = pos.coords;
      fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=${UNITS}&appid=${API_KEY}`)
        .then(r=>r.json()).then(current=> renderCurrent(current));
      fetch(`https://api.openweathermap.org/data/2.5/forecast?lat=${lat}&lon=${lon}&units=${UNITS}&appid=${API_KEY}`)
        .then(r=>r.json()).then(forecast=> renderForecast(forecast));
    }, ()=> fetchWeather('New York'));
  } else {
    fetchWeather('New York');
  }
});
</script>
</body>
</html>
